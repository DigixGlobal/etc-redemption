'use strict';

var Command = require('ronin').Command;
var path = require('path');
var glob = require('glob').sync;

module.exports = Command.extend({
  desc: 'List all available commands',

  run: function run(name) {
    var basePath = path.resolve(__dirname, '..');

    // modeled after https://github.com/vdemedes/ronin/blob/master/lib/program.js#L78
    var files = glob(path.join(basePath, 'commands', '**', '*.js'));
    var cmds = files.map(function (p) {
      return p.replace(/\//g, path.sep).replace(/^./, function ($1) {
        return $1.toUpperCase();
      }).replace(path.join(basePath, 'commands'), '').replace(path.sep, '').split(path.sep).join(' ').replace('.js', '');
    }).sort().map(function (cmd) {
      return 'ipfs ' + cmd;
    });

    console.log(['ipfs'].concat(cmds).join('\n'));
  }
});